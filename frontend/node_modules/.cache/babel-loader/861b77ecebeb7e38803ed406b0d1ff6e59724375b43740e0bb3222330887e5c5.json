{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Emily\\\\Desktop\\\\prueba-tecnica\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useState, useEffect, useCallback } from 'react';\nimport { getToken, setToken, removeToken, setRefreshToken } from '../api/token';\nimport { getMeApi } from '../api/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({\n  auth: undefined,\n  login: () => {},\n  logout: () => {},\n  loading: true\n});\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [auth, setAuth] = useState(undefined);\n  const [loading, setLoading] = useState(true);\n  const login = useCallback(async (accessToken, refreshToken) => {\n    setToken(accessToken);\n    if (refreshToken) {\n      setRefreshToken(refreshToken);\n    }\n    try {\n      const userData = await getMeApi(accessToken);\n      setAuth({\n        token: accessToken,\n        user: userData\n      });\n    } catch (error) {\n      console.error('Error obteniendo datos del usuario:', error);\n      removeToken();\n      setAuth(null);\n    }\n  }, []);\n  const logout = useCallback(() => {\n    removeToken();\n    setAuth(null);\n  }, []);\n  useEffect(() => {\n    const validateToken = async () => {\n      const token = getToken();\n      if (!token) {\n        setAuth(null);\n        setLoading(false);\n        return;\n      }\n      try {\n        const userData = await getMeApi(token);\n        setAuth({\n          token,\n          user: userData\n        });\n      } catch (error) {\n        console.error('Token inválido:', error);\n        removeToken();\n        setAuth(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n    validateToken();\n  }, []);\n  const contextValue = {\n    auth,\n    login,\n    logout,\n    loading\n  };\n  if (loading) {\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextValue,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"o3bOkfC0wXG2u47xP9BA4woeeZ0=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","useCallback","getToken","setToken","removeToken","setRefreshToken","getMeApi","jsxDEV","_jsxDEV","AuthContext","auth","undefined","login","logout","loading","AuthProvider","children","_s","setAuth","setLoading","accessToken","refreshToken","userData","token","user","error","console","validateToken","contextValue","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Emily/Desktop/prueba-tecnica/frontend/src/context/AuthContext.js"],"sourcesContent":["import { createContext, useState, useEffect, useCallback } from 'react';\nimport { getToken, setToken, removeToken, setRefreshToken } from '../api/token';\nimport { getMeApi } from '../api/auth';\n\nexport const AuthContext = createContext({\n  auth: undefined,\n  login: () => {},\n  logout: () => {},\n  loading: true,\n});\n\nexport function AuthProvider({ children }) {\n  const [auth, setAuth] = useState(undefined);\n  const [loading, setLoading] = useState(true);\n\n  const login = useCallback(async (accessToken, refreshToken) => {\n    setToken(accessToken);\n    if (refreshToken) {\n      setRefreshToken(refreshToken);\n    }\n\n    try {\n      const userData = await getMeApi(accessToken);\n      setAuth({\n        token: accessToken,\n        user: userData,\n      });\n    } catch (error) {\n      console.error('Error obteniendo datos del usuario:', error);\n      removeToken();\n      setAuth(null);\n    }\n  }, []);\n\n  const logout = useCallback(() => {\n    removeToken();\n    setAuth(null);\n  }, []);\n\n  useEffect(() => {\n    const validateToken = async () => {\n      const token = getToken();\n\n      if (!token) {\n        setAuth(null);\n        setLoading(false);\n        return;\n      }\n\n      try {\n        const userData = await getMeApi(token);\n        setAuth({\n          token,\n          user: userData,\n        });\n      } catch (error) {\n        console.error('Token inválido:', error);\n        removeToken();\n        setAuth(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    validateToken();\n  }, []);\n\n  const contextValue = {\n    auth,\n    login,\n    logout,\n    loading,\n  };\n\n  if (loading) {\n    return null;\n  }\n\n  return (\n    <AuthContext.Provider value={contextValue}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n"],"mappings":";;AAAA,SAASA,aAAa,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AACvE,SAASC,QAAQ,EAAEC,QAAQ,EAAEC,WAAW,EAAEC,eAAe,QAAQ,cAAc;AAC/E,SAASC,QAAQ,QAAQ,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvC,OAAO,MAAMC,WAAW,gBAAGX,aAAa,CAAC;EACvCY,IAAI,EAAEC,SAAS;EACfC,KAAK,EAAEA,CAAA,KAAM,CAAC,CAAC;EACfC,MAAM,EAAEA,CAAA,KAAM,CAAC,CAAC;EAChBC,OAAO,EAAE;AACX,CAAC,CAAC;AAEF,OAAO,SAASC,YAAYA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EACzC,MAAM,CAACP,IAAI,EAAEQ,OAAO,CAAC,GAAGnB,QAAQ,CAACY,SAAS,CAAC;EAC3C,MAAM,CAACG,OAAO,EAAEK,UAAU,CAAC,GAAGpB,QAAQ,CAAC,IAAI,CAAC;EAE5C,MAAMa,KAAK,GAAGX,WAAW,CAAC,OAAOmB,WAAW,EAAEC,YAAY,KAAK;IAC7DlB,QAAQ,CAACiB,WAAW,CAAC;IACrB,IAAIC,YAAY,EAAE;MAChBhB,eAAe,CAACgB,YAAY,CAAC;IAC/B;IAEA,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMhB,QAAQ,CAACc,WAAW,CAAC;MAC5CF,OAAO,CAAC;QACNK,KAAK,EAAEH,WAAW;QAClBI,IAAI,EAAEF;MACR,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;MAC3DrB,WAAW,CAAC,CAAC;MACbc,OAAO,CAAC,IAAI,CAAC;IACf;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAML,MAAM,GAAGZ,WAAW,CAAC,MAAM;IAC/BG,WAAW,CAAC,CAAC;IACbc,OAAO,CAAC,IAAI,CAAC;EACf,CAAC,EAAE,EAAE,CAAC;EAENlB,SAAS,CAAC,MAAM;IACd,MAAM2B,aAAa,GAAG,MAAAA,CAAA,KAAY;MAChC,MAAMJ,KAAK,GAAGrB,QAAQ,CAAC,CAAC;MAExB,IAAI,CAACqB,KAAK,EAAE;QACVL,OAAO,CAAC,IAAI,CAAC;QACbC,UAAU,CAAC,KAAK,CAAC;QACjB;MACF;MAEA,IAAI;QACF,MAAMG,QAAQ,GAAG,MAAMhB,QAAQ,CAACiB,KAAK,CAAC;QACtCL,OAAO,CAAC;UACNK,KAAK;UACLC,IAAI,EAAEF;QACR,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOG,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,iBAAiB,EAAEA,KAAK,CAAC;QACvCrB,WAAW,CAAC,CAAC;QACbc,OAAO,CAAC,IAAI,CAAC;MACf,CAAC,SAAS;QACRC,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC;IAEDQ,aAAa,CAAC,CAAC;EACjB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,YAAY,GAAG;IACnBlB,IAAI;IACJE,KAAK;IACLC,MAAM;IACNC;EACF,CAAC;EAED,IAAIA,OAAO,EAAE;IACX,OAAO,IAAI;EACb;EAEA,oBACEN,OAAA,CAACC,WAAW,CAACoB,QAAQ;IAACC,KAAK,EAAEF,YAAa;IAAAZ,QAAA,EACvCA;EAAQ;IAAAe,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAE3B;AAACjB,EAAA,CAxEeF,YAAY;AAAAoB,EAAA,GAAZpB,YAAY;AAAA,IAAAoB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}